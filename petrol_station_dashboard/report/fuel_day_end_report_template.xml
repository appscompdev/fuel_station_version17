<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="paperformat_day_end" model="report.paperformat">
        <field name="name">Fuel Day End Paper formate</field>
        <field name="default" eval="False"/>
        <field name="disable_shrinking" eval="True"/>
        <field name="format">A4</field>
        <field name="page_height">0</field>
        <field name="page_width">0</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">50</field>
        <field name="header_spacing">45</field>
        <field name="margin_bottom">25</field>
        <field name="margin_left">0</field>
        <field name="margin_right">0</field>
        <field name="dpi">140</field>
    </record>

    <record id="report_day_end_action" model="ir.actions.report">
        <field name="name">Fuel Day End Report</field>
        <field name="model">account.payment</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">petrol_station_dashboard.report_fuel_day_close_template</field>
        <field name="report_file">petrol_station_dashboard.report_fuel_day_close_template</field>
        <field name="paperformat_id" ref="paperformat_day_end"/>
    </record>

    <template id="report_fuel_day_close_template">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <center>
                        <h2>
                            <span>DAY END REPORT</span>
                        </h2>
                    </center>
                    <br/>
                    <table class="table table-borderless" style="border: 0px">
                        <tr align="left" style="border: 0px">
                            <td style="border: 0px">
                                <strong>Report From</strong>
                            </td>
                            <td style="border: 0px">:</td>
                            <td align="right" style="border: 0px">
                                <span t-esc="start_date"/>
                            </td>
                            <td style="border: 0px"/>
                            <td style="border: 0px"/>
                            <td style="border: 0px" align="left">
                                <strong>Report To</strong>
                            </td>
                            <td style="border: 0px">:</td>
                            <td style="border: 0px; background-color: #ffffff;" align="right">
                                <span t-esc="end_date"/>
                            </td>
                        </tr>
                        <tr>
                            <td style="border: 0px" align="left">
                                <strong>Generated By</strong>
                            </td>
                            <td style="border: 0px">:</td>
                            <td style="border: 0px" align="right">
                                <span t-field="res_company.env.user.name"/>
                            </td>
                            <td style="border: 0px"/>
                            <td style="border: 0px"/>
                            <td style="border: 0px" align="left">
                                <strong>Generated Date</strong>
                            </td>
                            <td style="border: 0px">:</td>
                            <td style="border: 0px; background-color: #ffffff;" align="right">
                                <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%m-%Y')"/>
                            </td>
                        </tr>
                    </table>
                    <t t-set="total_sale" t-value="0"/>
                    <t t-set="expense_sale" t-value="0"/>
                    <t t-set="indent_sale" t-value="0"/>
                    <t t-if="sale_dic">
                        <table class="table table-sm table-bordered mt-4"
                               style="page-break-inside: avoid;border-color:#000;">
                            <thead style="page-break-inside: avoid;">
                                <th class="text-center"
                                    style="width: 8%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    S.No
                                </th>
                                <th class="text-center"
                                    style="width: 8%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Product
                                </th>
                                <th class="text-center"
                                    style="width: 8%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Sale
                                </th>
                                <th class="text-center"
                                    style="width: 8%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Price
                                </th>
                                <th class="text-center"
                                    style="width: 8%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Total
                                </th>
                            </thead>
                            <tbody>
                                <t t-foreach="sale_dic" t-as="j">
                                    <tr style="page-break-inside: avoid;">
                                        <td class="text-center">
                                            <span t-esc="j_index+1"/>
                                        </td>
                                        <td class="text-start">
                                            <span t-esc="j.display_name"/>
                                        </td>
                                        <t t-foreach="j_value" t-as="k">
                                            <t t-if="k == 'sale'">
                                                <td class="text-end">
                                                    <span t-esc="k_value"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                            </t>
                                            <t t-if="k == 'today_price'">
                                                <td class="text-end">
                                                    <span t-esc="k_value"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                            </t>
                                            <t t-if="k == 'total_price'">
                                                <td class="text-end">
                                                    <span t-esc="k_value"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>

                                                <t t-set="total_sale" t-value="total_sale + k_value"/>
                                            </t>
                                        </t>
                                    </tr>
                                </t>
                                <tr style="page-break-inside: avoid;">
                                    <td colspan="4" class="text-end">
                                        <strong>Total</strong>
                                    </td>
                                    <td class="text-end">
                                        <strong t-esc="total_sale" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <h5 class="text-start mt-4 font-weight-bolder">QC/QT-Check</h5>

                        <table class="table table-sm table-bordered mt-4"
                               style="page-break-inside: avoid;border-color:#000;">
                            <thead style="page-break-inside: avoid;">
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    S.No
                                </th>
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Product
                                </th>
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Qty
                                </th>
                            </thead>
                            <tbody>
                                <t t-foreach="sale_dic" t-as="j">
                                    <t t-foreach="j_value" t-as="k">
                                        <t t-if="k == 'in'">
                                            <t t-if="k_value != 0.00">
                                                <tr style="page-break-inside: avoid;">
                                                    <td class="text-center">
                                                        <span t-esc="j_index+1"/>
                                                    </td>
                                                    <td class="text-start">
                                                        <span t-esc="j.display_name"/>
                                                    </td>
                                                    <td class="text-end">
                                                        <span t-esc="k_value"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                    </t>
                    <t t-if="credit_ids">
                        <h5 class="text-start mt-4 font-weight-bolder">Indent Sale</h5>
                        <table class="table table-sm table-bordered mt-4"
                               style="page-break-inside: avoid;border-color:#000;">
                            <thead style="page-break-inside: avoid;">
                                <th class="text-center"
                                    style="width: 10%;font-weight:bold;background-color: #0048ad;color:#fff;">
                                    S.No
                                </th>
                                <th class="text-center"
                                    style="width: 10%;font-weight:bold;background-color: #0048ad;color:#fff;">
                                    Customer
                                </th>
                                <th class="text-center"
                                    style="width: 10%;font-weight:bold;background-color: #0048ad;color:#fff;">
                                    Indent No
                                </th>
                                <th class="text-center"
                                    style="width: 10%;font-weight:bold;background-color: #0048ad;color:#fff;">
                                    Amount
                                </th>
                            </thead>
                            <tbody>
                                <t t-foreach="credit_ids" t-as="ci">
                                    <tr style="page-break-inside: avoid;">
                                        <td class="text-center">
                                            <span t-esc="ci_index+1"/>
                                        </td>
                                        <t t-foreach="ci" t-as="ci1">

                                            <t t-if="ci1 != 'amount'">
                                                <td class="text-start">
                                                    <span t-esc="ci1_value"/>
                                                </td>
                                            </t>
                                            <t t-if="ci1 == 'amount'">
                                                <td class="text-end">
                                                    <span t-esc="ci1_value"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <t t-set="indent_sale" t-value="indent_sale + ci1_value"/>
                                            </t>
                                        </t>
                                    </tr>
                                </t>
                                <tr style="page-break-inside: avoid;">
                                    <td colspan="3" class="text-end">
                                        <strong>Total</strong>
                                    </td>
                                    <td class="text-end">
                                        <span t-esc="indent_sale" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </t>

                    <t t-if="expense_ids">
                        <h5 class="text-start mt-4 font-weight-bolder">Expense</h5>
                        <table class="table table-sm table-bordered mt-4"
                               style="page-break-inside: avoid;border-color:#000;">
                            <thead style="page-break-inside: avoid;">
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    S.No
                                </th>
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Pump
                                </th>
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Description
                                </th>
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Category
                                </th>
                                <th class="text-center"
                                    style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                    Amount
                                </th>
                            </thead>
                            <tbody>
                                <t t-foreach="expense_ids" t-as="ex">
                                    <tr style="page-break-inside: avoid;">
                                        <td class="text-center">
                                            <span t-esc="ex_index+1"/>
                                        </td>
                                        <t t-foreach="ex" t-as="exi">
                                            <t t-if="exi != 'amount'">
                                                <td class="text-start">
                                                    <span t-esc="exi_value"/>
                                                </td>
                                            </t>
                                            <t t-if="exi == 'amount'">
                                                <td class="text-end">
                                                    <span t-esc="exi_value"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <t t-set="expense_sale" t-value="expense_sale + exi_value"/>
                                            </t>
                                        </t>
                                    </tr>
                                </t>
                                <tr style="page-break-inside: avoid;">
                                    <td colspan="4" class="text-end">
                                        <strong>Total</strong>
                                    </td>
                                    <td class="text-end">
                                        <span t-esc="expense_sale" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </t>

                    <t t-set="payment_val" t-value="0"/>
                    <t t-set="bank_val" t-value="0"/>
                    <t t-set="cash_val" t-value="0"/>

                    <div class="row">
                        <div class="col-5">
                            <h5 class="text-start mt-4 font-weight-bolder">Advance Info</h5>
                            <table class="table table-sm table-bordered mt-4"
                                   style="page-break-inside: avoid;border-color:#000;">
                                <thead style="page-break-inside: avoid;">
                                    <th class="text-center"
                                        style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                        Payment Mode
                                    </th>
                                    <th class="text-center"
                                        style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                        Amount
                                    </th>
                                </thead>
                                <tbody>
                                    <t t-foreach="payment" t-as="p">
                                        <tr style="page-break-inside: avoid;">


                                            <t t-if="p_value">
                                                <td class="text-start">
                                                    <span t-esc="p"/>
                                                </td>
                                                <td class="text-end">
                                                    <span t-esc="p_value"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <t t-set="payment_val" t-value="payment_val + p_value"/>

                                                <t t-if="p == 'Cash'">
                                                    <t t-set="cash_val" t-value="cash_val + p_value"/>
                                                </t>
                                                <t t-else="">
                                                    <t t-set="bank_val" t-value="bank_val + p_value"/>
                                                </t>
                                            </t>
                                        </tr>
                                    </t>
                                    <tr>
                                        <td class="text-start">
                                            <strong>Total</strong>
                                        </td>
                                        <td class="text-end">
                                            <span t-esc="payment_val" t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-2"/>
                        <div class="col-5">
                            <h5 class="text-start mt-4 font-weight-bolder">Summary Info</h5>
                            <table class="table table-sm table-bordered mt-4"
                                   style="page-break-inside: avoid;border-color:#000;">
                                <thead style="page-break-inside: avoid;">
                                    <th colspan="2" class="text-center"
                                        style="width: 10%; font-weight:bold; background-color: #0048ad; color:#fff;">
                                        OverAll Summary
                                    </th>
                                </thead>
                                <tbody>
                                    <t t-if="total_sale">
                                        <tr style="page-break-inside: avoid;">
                                            <td class="text-start">
                                                <strong>Sale</strong>
                                            </td>
                                            <td class="text-end">
                                                <strong t-esc="total_sale"
                                                        t-options='{"widget": "float", "precision": 2}'/>
                                            </td>
                                        </tr>
                                    </t>

                                    <t t-if="indent_sale">
                                        <tr style="page-break-inside: avoid;">
                                            <td class="text-start">
                                                <strong>Credit Sale</strong>
                                            </td>
                                            <td class="text-end">
                                                <strong t-esc="indent_sale"
                                                        t-options='{"widget": "float", "precision": 2}'/>
                                            </td>
                                        </tr>
                                    </t>

                                    <t t-if="expense_sale">
                                        <tr style="page-break-inside: avoid;">
                                            <td class="text-start">
                                                <strong>Expense</strong>
                                            </td>
                                            <td class="text-end">
                                                <strong t-esc="expense_sale"
                                                        t-options='{"widget": "float", "precision": 2}'/>
                                            </td>
                                        </tr>
                                    </t>
                                    <t t-if="cash_val">
                                        <tr style="page-break-inside: avoid;">
                                            <td class="text-start">
                                                <strong>Advance(Cash)</strong>
                                            </td>
                                            <td class="text-end">
                                                <strong t-esc="cash_val"
                                                        t-options='{"widget": "float", "precision": 2}'/>
                                            </td>
                                        </tr>
                                    </t>
                                    <t t-if="bank_val">
                                        <tr style="page-break-inside: avoid;">
                                            <td class="text-start">
                                                <strong>Advance(Bank)</strong>
                                            </td>
                                            <td class="text-end">
                                                <strong t-esc="bank_val"
                                                        t-options='{"widget": "float", "precision": 2}'/>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="page-break-inside: avoid;">
                                        <td class="text-start">
                                            <strong>Balance</strong>
                                        </td>
                                        <td class="text-end">
                                            <t t-set="balance"
                                               t-value="total_sale - indent_sale - expense_sale - cash_val - bank_val"/>
                                            <strong t-esc="abs(balance)"
                                                    t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <br/>
                    <div class="footer" align="right" style="margin-top: 10px; font-size:14px">
                        <div class="text-center" align="center">
                            <br/>
                            <br/>
                            <br/>
                            <br/>
                            Page
                            <span class="page"/>
                            of
                            <span class="topage"/>
                            Print Date
                            <strong class="px-2">:</strong>
                            <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%m-%Y')"/>
                            <strong class="px-2">:</strong>
                            Print Time
                            <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%H:%M:%S')"/>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>
